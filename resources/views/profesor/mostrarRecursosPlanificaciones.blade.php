@extends('layouts.profesor')@section('title', 'Timonel')@section('style')    <link rel="stylesheet" href="{{ asset('public/assets/magnific/dist/magnific-popup.css') }}">@endsection@section('content')    <section class="content-header">        <h1>            Recursos de {{ $materia }}        </h1>    </section>    <!-- Main content -->    <section class="content">        <div class="row">            <div class="col-md-12">                <div class="box box-primary">                    <div class="box-header with-border">                        <input type="hidden" id="grado_id" value="{{ $grado_id }}">                        <input type="hidden" id="materia_id" value="{{ $materia_id }}">                    </div>                    <div class="box-body no-padding">                        @if (!empty($temas))                            <div class="mailbox-read-info">                                <div class="row">                                    <div class="col-md-1">                                        <h4><strong>Unidad:</strong></h4>                                    </div>                                    <div class="col-md-3">                                        <select name="unidad" id="unidad" class="form-control unidad">                                            <option value="">Seleccionar unidad</option>                                            @foreach ($temas as $tema)                                                <option value="{{ $tema->unidad_id }}">{{ $tema->unidad_id }}</option>                                            @endforeach                                        </select>                                    </div>                                    <div class="col-md-4">                                        <button class="btn btn-success" id="consultar">Mostrar</button>                                    </div>                                </div>                            </div>                            <div class="box-footer">                                <h4><strong>Archivos:</strong></h4>                                <ul class="mailbox-attachments list-inline" id="archivos">                                </ul>                            </div>                        @else                            <div class="col-md-12">                                <h4>No hay archivos para mostrar!</h4>                            </div>                        @endif                    </div>                    <!-- /.box-header -->                    <!-- form start -->                </div>                <!-- /.box -->            </div>        </div>    </section>    </div>@endsection@section('script')    <script src="{{ asset('public/assets/magnific/dist/jquery.magnific-popup.min.js') }}"></script>    <script>        $(document).ready(function() {            $.ajaxSetup({                headers: {                    'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')                }            });            var BASE = "{{ url('/') }}";            var grado_id = $("#grado_id").val();            var materia_id = $("#materia_id").val();            $('#consultar').on('click', function() {                var unidad_id = $("#unidad").val();                if (unidad_id !== '') {                    //Consultar a la base de datos                    $.post(BASE + '/profesor/planificacion/archivos', {                        unidad_id: unidad_id,                        materia_id: materia_id,                        grado_id: grado_id                    }, function(archivos) {                        $("#archivos").html('');                        $.each(archivos, function(i, j) {                            var archivo = BASE + '/public/planificacion/' + j['recurso_id'] + '/' +                                j['archivo'];                            if (j['mime'] == 'application/pdf') {                                $("#archivos").append(                                    '<li> <span class="mailbox-attachment-icon"><i class="bx bxs-file-pdf"></i></span><div class="mailbox-attachment-info"><button title="Doble click para ver archivo" class="mailbox-attachment-name iframe-popup" archivo="' +                                    archivo + '"> <i class="ri-search-eye-line"></i> ' +                                    j[                                        'nombre_archivo'] + '</button><br>' +                                    '<a download class="btn btn-sm btn-secondary" href="' +                                    archivo +                                    '" style="width: 100%;text-overflow: ellipsis;white-space: nowrap;overflow: hidden;"> <i class="bx bx-download"></i> ' +                                    j['nombre_archivo'] +                                    '</a> <span class="mailbox-attachment-size">' + j[                                        'tam'] + ' KB</span></div></li>');                            } else if (j['mime'] == 'image/png' || j['mime'] ==                                'image/gif' || j['mime'] == 'image/jpeg') {                                $("#archivos").append(                                    '<li> <span class="mailbox-attachment-icon"><i class="bx bxs-file-image"></i></span><div class="mailbox-attachment-info"><button title="Doble click para ver archivo" class="mailbox-attachment-name image-popup-vertical-fit" archivo="' +                                    archivo + '"> <i class="ri-search-eye-line"></i> ' +                                    j[                                        'nombre_archivo'] + '</button>' +                                    '<a download class="btn btn-sm btn-secondary" href="' +                                    archivo +                                    '" style="width: 100%;text-overflow: ellipsis;white-space: nowrap;overflow: hidden;"> <i class="bx bx-download"></i> ' +                                    j['nombre_archivo'] +                                    '</a><span class="mailbox-attachment-size">' + j[                                        'tam'] + ' KB</span></div></i>');                            } else if (j['mime'] == 'video/mp4' || j['mime'] ==                                'audio/mpeg') {                                $("#archivos").append(                                    '<li> <span class="mailbox-attachment-icon"><i class="bx bxl-youtube"></i></span><div class="mailbox-attachment-info"><button title="Doble click para ver archivo" class="mailbox-attachment-name popup-youtube" archivo="' +                                    archivo + '"> <i class="ri-search-eye-line"></i> ' +                                    j[                                        'nombre_archivo'] + '</button>' +                                    '<a download class="btn btn-sm btn-secondary" href="' +                                    archivo +                                    '" style="width: 100%;text-overflow: ellipsis;white-space: nowrap;overflow: hidden;"> <i class="bx bx-download"></i> ' +                                    j['nombre_archivo'] +                                    '</a><span class="mailbox-attachment-size">' + j[                                        'tam'] + ' KB</span></div></i>');                            } else if (j['mime'] ==                                'application/vnd.openxmlformats-officedocument.wordprocessingml.document'                            ) {                                $("#archivos").append(                                    '<li> <span class="mailbox-attachment-icon"><i class="bx bxs-file-doc"></i></span><div class="mailbox-attachment-info"><button title="Doble click para ver archivo" class="mailbox-attachment-name archivo_word" archivo="' +                                    archivo + '"> <i class="ri-search-eye-line"></i> ' +                                    j[                                        'nombre_archivo'] + '</button>' +                                    '<a download class="btn btn-sm btn-secondary" href="' +                                    archivo +                                    '" style="width: 100%;text-overflow: ellipsis;white-space: nowrap;overflow: hidden;"> <i class="bx bx-download"></i> ' +                                    j['nombre_archivo'] +                                    '</a><span class="mailbox-attachment-size">' + j[                                        'tam'] + ' KB</span></div></i>');                            }                        });                    });                } else {                    swal({                        title: "Alerta!",                        type: "error",                        text: "Debe Seleccionar La Unidad!",                    });                }            });        });        $('body').on('click', '.popup-youtube', function() {            var archivo = $(this).attr('archivo');            $(this).magnificPopup({                items: {                    src: archivo,                    disableOn: 700,                    type: 'iframe',                    mainClass: 'mfp-fade',                    removalDelay: 160,                    preloader: false,                    fixedContentPos: false                }            });        });        // Popup para imágenes con clase .image-popup-vertical-fit        $('body').on('click', '.image-popup-vertical-fit', function() {            var archivo = $(this).attr('archivo');            $.magnificPopup.open({                items: {                    src: archivo                },                type: 'image',                closeOnContentClick: true,                mainClass: 'mfp-img-mobile',                image: {                    verticalFit: true                }            });        });        // Popup para archivos PDF con clase .iframe-popup        $('body').on('click', '.iframe-popup', function() {            var archivo = $(this).attr('archivo');            $.magnificPopup.open({                items: {                    src: archivo,                    type: 'iframe'                },                type: 'iframe',                mainClass: 'mfp-fade',                removalDelay: 160,                preloader: false,                fixedContentPos: false            });        });        // Popup para imágenes en general        $('.image-popup-general').magnificPopup({            type: 'image',            closeOnContentClick: true,            mainClass: 'mfp-img-mobile',            image: {                verticalFit: true            }        });        $('body').on('click', '.archivo_word', function() {            var archivo = $(this).attr('archivo');            var url = "https://docs.google.com/viewer?url=" + archivo;            window.open(url);        });    </script>@endsection